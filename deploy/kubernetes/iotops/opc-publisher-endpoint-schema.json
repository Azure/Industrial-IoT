{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "DeviceEndpointModel",
  "description": "Configuration model for OPC UA endpoint security and connection settings.",
  "type": "object",
  "properties": {
    "EndpointSecurityPolicy": {
      "type": ["string", "null"],
      "minLength": 1,
      "maxLength": 512,
      "examples": ["Basic256Sha256", "Aes256_Sha256_RsaPss", "http://opcfoundation.org/UA/SecurityPolicy#Basic256Sha256"],
      "description": "The security policy URI to use for the endpoint connection. Defines the encryption and signing algorithms used for communication.",
      "errorMessage": {
        "type": "Must be a string or null",
        "minLength": "Security policy cannot be empty",
        "maxLength": "Security policy cannot exceed 512 characters"
      }
    },
    "EndpointSecurityMode": {
      "type": ["string", "null"],
      "enum": ["None", "Sign", "SignAndEncrypt"],
      "default": "SignAndEncrypt",
      "examples": ["None", "Sign", "SignAndEncrypt"],
      "description": "The security mode to use for the endpoint. None (no security), Sign (messages signed), or SignAndEncrypt (messages signed and encrypted).",
      "errorMessage": {
        "enum": "Must be one of: None, Sign, SignAndEncrypt"
      }
    },
    "UseReverseConnect": {
      "type": ["boolean", "null"],
      "default": false,
      "examples": [true, false],
      "description": "Use reverse connect to connect to the endpoint. Enable when the server needs to initiate the connection to the client.",
      "errorMessage": {
        "type": "Must be a boolean or omitted"
      }
    },
    "RunAssetDiscovery": {
      "type": ["boolean", "null"],
      "default": false,
      "examples": [true, false],
      "description": "Runs asset discovery on the endpoint. Enable to automatically discover and catalog available assets.",
      "errorMessage": {
        "type": "Must be a boolean or omitted"
      }
    },
    "AssetTypes": {
      "type": ["array", "null"],
      "items": {
        "type": "string",
        "minLength": 1,
        "maxLength": 256
      },
      "uniqueItems": true,
      "examples": [["ns=1;s=PumpType", "nsu=https://opcfoundation.org/UA;i=2345"]],
      "description": "List of asset types to discover when RunAssetDiscovery is enabled. Each type must be unique.",
      "errorMessage": {
        "uniqueItems": "Asset types must be unique",
        "items": {
          "minLength": "Asset type name cannot be empty",
          "maxLength": "Asset type name cannot exceed 256 characters"
        }
      }
    },
    "DumpConnectionDiagnostics": {
      "type": ["boolean", "null"],
      "default": false,
      "examples": [true, false],
      "description": "Enables detailed server diagnostics logging for the connection. Enable for troubleshooting connection issues.",
      "errorMessage": {
        "type": "Must be a boolean or omitted"
      }
    }
  },
  "additionalProperties": false,
  "dependencies": {
    "AssetTypes": ["RunAssetDiscovery"]
  }
}
