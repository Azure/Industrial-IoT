pr:
  autoCancel: 'true'
  drafts: 'true'
  branches:
    include:
    - '*'
variables:
  system_accesstoken: $(System.AccessToken)
jobs:
- job: OneBranchTrigger
  pool:
    vmImage: 'ubuntu-latest'
  displayName: Trigger Pull Request Build on Governed Pipeline
  steps:
  - task: TriggerBuild@4
    inputs:
      buildDefinition: 'Industrial-IoT-PullRequest'
      definitionIsInCurrentTeamProject: true
      templateParameters: 'ref: $(Build.SourceBranch)'
      queueBuildForUserThatTriggeredBuild: true
      waitForQueuedBuildsToFinish: true
      waitForQueuedBuildsToFinishRefreshTime: '60'
      failTaskIfBuildsNotSuccessful: true
      downloadBuildArtifacts: true
      authenticationMethod: 'OAuth Token'
      password: $(system_accesstoken)
